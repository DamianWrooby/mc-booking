<form (ngSubmit)="onSubmit(createJobForm)" #createJobForm="ngForm" class="align-left">
	<fieldset class="mb-5">
		<label for="title" class="font-bold block mb-1">Tytuł</label>
		<input id="title" pInputText type="text" name="title" #titleModel="ngModel" [(ngModel)]="formModel.title"
			class="w-full" required [invalid]="titleModel.invalid && (titleModel.touched || createJobForm.submitted)" />
		@if (titleModel.invalid && titleModel.touched) {
		<p-message severity="error" size="small" variant="simple">To pole jest wymagane</p-message>
		}
	</fieldset>

	<fieldset class="mb-5">
		<label for="description" class="font-bold block mb-1">Opis</label>
		<textarea id="description" name="description" rows="5" col="30" pTextarea #descriptionModel="ngModel"
			[(ngModel)]="formModel.description" class="w-full"
			[invalid]="descriptionModel.invalid && (descriptionModel.touched || createJobForm.submitted)" required>
		</textarea>
		@if (descriptionModel.invalid && descriptionModel.touched) {
		<p-message severity="error" size="small" variant="simple">To pole jest wymagane</p-message>
		}
	</fieldset>

	<fieldset class="mb-5">
		<label for="location" class="font-bold block mb-1">Miejsce</label>
		<input id="location" name="location" pInputText type="text" #locationModel="ngModel"
			[(ngModel)]="formModel.location" class="w-full" required
			[invalid]="locationModel.invalid && (locationModel.touched || createJobForm.submitted)" />
		@if (locationModel.invalid && locationModel.touched) {
		<p-message severity="error" size="small" variant="simple">To pole jest wymagane</p-message>
		}
	</fieldset>

	<fieldset class="mb-5">
		<label for="startDate" class="font-bold block mb-1">Data rozpoczęcia</label>
		<p-datepicker #startDateModel="ngModel" inputId="startDate" name="startDate" [(ngModel)]="formModel.startDate"
			[invalid]="startDateModel.invalid && (startDateModel.touched || createJobForm.submitted)" [showTime]="true"
			hourFormat="24" required></p-datepicker>
		@if (startDateModel.invalid && startDateModel.touched) {
		<p-message severity="error" size="small" variant="simple">To pole jest wymagane</p-message>
		}
	</fieldset>

	<fieldset class="mb-5">
		<label for="endDate" class="font-bold block mb-1">Data zakończenia</label>
		<p-datepicker name="endDate" #endDateModel="ngModel" inputId="endDate" [(ngModel)]="formModel.endDate"
			[invalid]="endDateModel.invalid && (endDateModel.touched || createJobForm.submitted)" [showTime]="true"
			hourFormat="24" required></p-datepicker>
		@if (endDateModel.invalid && endDateModel.touched) {
		<p-message severity="error" size="small" variant="simple">To pole jest wymagane</p-message>
		}
	</fieldset>

	<fieldset class="mb-5">
		<label for="assignedUsers" class="font-bold block mb-1">Przypisani użytkownicy</label>
		<p-autocomplete
			inputId="assignedUsers"
			[(ngModel)]="selectedUser"
			[suggestions]="filteredUsers()"
			(completeMethod)="filterUsers($event)"
			(onSelect)="onUserSelect($event)"
			[completeOnFocus]="true"
			optionLabel="username"
			placeholder="Wyszukaj użytkowników..."
			styleClass="w-full">
		</p-autocomplete>
		@if (formModel.assignedUsers.length > 0) {
			<ul class="mt-2 flex flex-col gap-1">
				@for (user of formModel.assignedUsers; track user.id) {
					<li class="flex items-center justify-between p-2 bg-surface-100 dark:bg-surface-800 rounded">
						<span>{{ user.username }}</span>
						<button type="button" class="text-red-500 hover:text-red-700" (click)="removeUser(user)">
							<i class="pi pi-times"></i>
						</button>
					</li>
				}
			</ul>
		}
	</fieldset>

	<p-button type="submit" styleClass="w-48 mt-8 mx-auto" label="Utwórz"
		severity="danger" 	[loading]="loading()"
		[disabled]="!createJobForm.form.valid">
	</p-button>
</form>
<!-- <form class="align-left">
	<fieldset class="mb-5">
		<label for="title" class="font-bold block mb-1">Tytuł</label>
		<input id="title" pInputText type="text"
			class="w-full" [field]="form.title" />
		@if (form.title().invalid() && form.title().touched()) {
			<p-message severity="error" size="small" variant="simple">To pole jest wymagane</p-message>
		}
	</fieldset>

	<fieldset class="mb-5">
		<label for="description" class="font-bold block mb-1">Opis</label>
		<textarea id="description" rows="5" col="30" pTextarea
			class="w-full" [field]="form.description">
		</textarea>
		@if (form.description().invalid() && form.description().touched()) {
			<p-message severity="error" size="small" variant="simple">To pole jest wymagane</p-message>
		}
	</fieldset>

	<fieldset class="mb-5">
		<label for="location" class="font-bold block mb-1">Miejsce</label>
		<input id="location" pInputText type="text"
			class="w-full" [field]="form.location" />
		@if (form.location().invalid() && form.location().touched()) {
			<p-message severity="error" size="small" variant="simple">To pole jest wymagane</p-message>
		}
	</fieldset>

	<fieldset class="mb-5">
		<label for="startDate" class="font-bold block mb-1">Data rozpoczęcia</label>
		<p-datepicker inputId="startDate"
			[showTime]="true" [field]="form.startDate"
			hourFormat="24"></p-datepicker>
		@if (form.startDate().invalid() && form.startDate().touched()) {
			<p-message severity="error" size="small" variant="simple">To pole jest wymagane</p-message>
		}
	</fieldset>

	<fieldset class="mb-5">
		<label for="endDate" class="font-bold block mb-1">Data zakończenia</label>
		<p-datepicker inputId="endDate"
			[showTime]="true" [field]="form.endDate"
			hourFormat="24"></p-datepicker>
		@if (form.endDate().invalid() && form.endDate().touched()) {
			<p-message severity="error" size="small" variant="simple">To pole jest wymagane</p-message>
		}
	</fieldset>
	<p-button (onClick)="onSubmit()"
		type="submit" styleClass="w-48 mt-8 mx-auto"
		[label]="form().submitting() ? 'Wysyłanie...' : 'Wyślij'" 			
		severity="danger" 	[loading]="loading()"
		[disabled]="form().submitting()">
	</p-button>
</form> -->